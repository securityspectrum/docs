{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to the Security Spectrum Docs","text":"<p>The Security Spectrum platform is a cybersecurity SIEM solution that facilitates the detection and protection of customers' networks against malicious attacks, all while safeguarding the confidentiality of sensitive information contained within event logs.</p>"},{"location":"#description-of-the-problem","title":"Description of the problem","text":"<p>As many cybersecurity SIEM platforms, we rely on many open-source projects to generate cybersecurity event logs such as:</p> <ul> <li>Zeek: Is a free and open-source software network analysis framework</li> <li>OSSEC: OSSEC is a multiplatform, open source and free Host Intrusion Detection System (HIDS)</li> <li>Suricata: Suricata is an open-source based intrusion detection system (IDS) and intrusion prevention system (IPS)</li> <li>OpenVAS: The Open Vulnerability Assessment System, OpenVAS is a comprehensive open-source vulnerability scanning tool and vulnerability management system. and others. Naturally, these event logs will contain sensitive information such as IP addresses, emails, usernames, hostnames, and more which are visible in clear.</li> </ul> <p>Processing and storing sensitive information in clear is a security risk.</p>"},{"location":"#how-does-it-work","title":"How does it work?","text":"<p>Before going any further, let's describe shortly the terminology we will use.</p>"},{"location":"#terminology-description","title":"Terminology description","text":"<ul> <li>Event logs: The event logs are structured files containing records of event data. They originate from the customer's network which are processed and analyzed to detect any attacks or threats. Please note that our focus is mostly security event logs.</li> <li>Organization: The organization, the client or the customer are identical in our context.</li> <li>Managed Security Service Provider (MSSP): Organization specialized in cybersecurity and which offers cybersecurity  protection services to other organizations.</li> <li>Security Information and Event Management (SIEM): A SIEM platform that helps organizations detect and protect against cyber-attacks.</li> </ul> <p>To protect sensitive information, we rely on encryption mechanisms. When sensitive data is collected and processed, we believe that it needs to be encrypted as early as possible, before the events leave the customers network. In other words, we are talking about end-to-end encryption (E2EE).</p> <p>When discussing encryption, a critical question that arises is the following: Who possesses to the decryption key*?</p> <p>In our threat model, it is only the customer or the organization who has access to the secret keys. It is then up to them to decide to whom he wants to provide the decryption keys which will give access to data in clear.</p>"},{"location":"#end-to-end-encryption-e2ee","title":"End-to-end encryption (E2EE)","text":"<p>The privacy protection of sensitive information is achieved using the E2EE. To achieve high processing throughput of the event logs, we use symmetric encryption.</p> <p>The principal benefits of using E2EE is that our platforms assures that it is only the customer with the decryption keys that is able to decrypt encrypted sensitive information (PIIs). The owner of the organization can decide to whom he wants to grant access to sensitive information in cleartext by sharing the Data Decryption Key (DEK) to the desired user. This provides an extra layer of protection and gives customers full control over their sensitive data, improving their privacy and security.</p>"},{"location":"#why-privacy","title":"Why privacy?","text":"<p>Why do we care about privacy? We believe that the customer should have control of governance of personal data. As the time goes on, we believe that the importance of privacy will only increase as access to information gets easier.</p>"},{"location":"#why-are-we-doing-this","title":"Why are we doing this?","text":"<ol> <li>Privacy is important.</li> <li>We believe that a SOC analyst does not need to know all information in cleartext at all times during his investigation time.</li> <li>At the moment of writing, we were unable to find any single SIEM solution on the market which is protecting collected sensitive information with E2EE in the field of cybersecurity.</li> <li>Some organizations are hesitant to move to the cloud infrastructure because they could lose control of their own data.</li> <li>We believe that privacy and protecting sensitive information will make our civilization better.</li> </ol> <p>At Security Spectrum, we have implemented a solution that we believe is challenging, but important, and we are proud to offer a cybersecurity SIEM platform that prioritizes privacy and protecting sensitive information.</p>"},{"location":"about/","title":"About us","text":"<p>As a small start-up based in Montreal, Canada, our mission is to establish ourselves as a leader in cybersecurity protection solutions that prioritize privacy. </p> <p>Our journey began in 2021 with the vision of creating a robust and innovative platform that not only detects and protects against malicious cyber attacks but also safeguards the sensitive information of our clients. </p> <p>Our team is dedicated to developing cutting-edge technologies that utilize end-to-end encryption mechanisms, ensuring that only our clients have access to their sensitive data. We are passionate about promoting privacy and believe it is essential to the continued growth of our interconnected world.</p>"},{"location":"e2ee/","title":"End-To-End Encryption (E2EE)","text":"<p>We describe how we protect sensitive information with End-To-End Encryption (E2EE). It consists of two main parts.</p> <p>The first part is the setup part, which is the master key generation only known by the customer or the organization owner.</p> <p>The second part consists of encrypting sensitive personally identifiable information (PII) whenever the field is matched by the fluent-bit <code>encrypt</code> plugin when processing the security event logs.</p>"},{"location":"e2ee/#data-flow-diagram","title":"Data flow diagram","text":"<p>In this section, we describe how security event logs are encrypted by the log-shipper (i.e. fluent-bit) before they are sent to the cloud via Kafka messaging queue to be processed and persisted.</p> <p>The owner of the organization knows the master key (secret key) is then able to decrypt sensitive information by providing the master key. At no point is the cloud aware of the master key. All decryptions of sensitive information are computed exclusively on the client side browser.</p>"},{"location":"e2ee/#first-part-setup","title":"First part (setup)","text":"<p>The setup phase must be completed by the owner of the organization right after a new organization has been created. Its accessible through:</p> <ul> <li>Settings -&gt; Privacy -&gt; Setup Encryption Key view.</li> <li>Click on Setup Encryption Key button.</li> </ul> <p> </p> Figure 1: Setup Encryption Key <p>A new window will appear with three fields to fill in:</p> <ul> <li>Master Key</li> <li>Data Encryption Key</li> <li>Data Encryption Key valid date from  <p> </p> Figure 2: Generate Master Key and Data Encryption Key"},{"location":"e2ee/#second-part-processing","title":"Second part (processing)","text":"<p>The event logs are generated in the customers site by various security agents. These security event logs are stored in files and are read by the log-shipper (i.e. fluent-bit). Fluent-bit processes the event logs and checks for the matching PII fields. Any matching PII field is then encrypted using the data encryption key (DEK) which was generated by the owner of the organization during the setup phase.</p> <p>Event-logs are shipped to the cloud in pseudonymized format.</p> <p> </p> Figure 3: Data flow diagram"},{"location":"e2ee/#decryption-of-piis","title":"Decryption of PIIs","text":"<p>The decryption of Personal Identifiable Information (PII) occurs exclusively on the clyde site browser. A user is able to decrypt encrypted PII field by providing the valid Master Key that he has selected during the setup phase.</p>"},{"location":"e2ee/#encryption-mechanisms","title":"Encryption mechanisms","text":"<p>We support four encryption mechanisms:</p> <ul> <li>AES-GCM: AES-GCM (Galois/Counter Mode) is the standard encryption scheme. It does not preserve the utility or searching capability of the data because every ciphertext is unique.</li> <li>AES-GCM DET: AES-GCM deterministic. It preserves the searching functionality of the encrypted values but is a weaker form of encryption because the IV is derived from the input message.</li> <li>CryptopANT IPv4/IPv6: IPv4/IPv6 encryption scheme built on top of open-source CryptopANT encryption algorithm. For more information: https://ant.isi.edu/software/cryptopANT/index.html</li> <li>HMAC-SHA256: HMAC uses the SHA-256 hash function which is a one way function implying that plaintext cannot be decrypted or visible in clear.</li> </ul> <p>The encryption mechanisms source-code is also available on our github page.</p>"},{"location":"e2ee/#encryption-keys","title":"Encryption keys","text":"<p>The encryption keys are generated in the setup phase. At no point is the Master Key shared with the backend server or the cloud. The owner of the organization can decide with whom he wants to share its keys.</p> <p>The Master Key is used to encrypt the Data Encryption Key which is a key that is used to encrypt or decrypt the data in clear.</p> <p>In order for the log-shipper (i.e. fluent-bit) to encrypt sensitive PII fields, the Master Key must be specified in the configuration file which is used by the fluent-bit software.</p>"},{"location":"e2ee/#privacy-by-default","title":"Privacy by default","text":"<p>Our SIEM platform is pre-configured to encrypt sensitive PII fields for our support security event type logs.</p>"},{"location":"limitations/","title":"Limitations","text":"<p>In this section, we describe the current limitations in our SIEM platform.</p>"},{"location":"limitations/#encryption","title":"Encryption","text":"<p>We do not support the following functionalities:</p> <ul> <li>MAC address encryption.</li> <li>Key rotation on a recurrent time basis (e.g. day, week, or month).</li> <li>Multi-user encryption support - where each user has its own decryption keys.</li> <li>RBAC based on fields.</li> </ul>"},{"location":"limitations/#log-shipper-agents","title":"Log-shipper agents","text":"<ul> <li>fluent-bit is not supported on Windows for two reasons:</li> <li>kafka output plugin is disabled on Windows by fluent-bit organization, see #1944.</li> <li>encrypt filter a plugin developed by our organization is not fully implemented to support Windows OS.</li> </ul>"},{"location":"quickstart/","title":"How to use","text":"<p>We describe the steps on how to use our SIEM platform. We describe how to start using the application in a few steps.</p>"},{"location":"quickstart/#requirements","title":"Requirements","text":"<ul> <li>Have an account on securityspectrum.io.</li> <li>Must have fluent-bit (log-shipper) with <code>encrypt</code> filter plugin and <code>kafka</code> output installed on the device which parses and encrypt logs.</li> <li>Get the fluent-bit with <code>encrypt</code> plugin from https://github.com/securityspectrum/fluent-bit/releases</li> <li>Please note that Windows OS is not supported at the moment.</li> <li>The following Operating Systems are supported:<ul> <li>ubuntu</li> <li>centos</li> <li>amazonlinux</li> <li>debian</li> <li>raspbian</li> </ul> </li> <li>Must have at least one of the supported security agents installed that will monitor and generate the logs in JSON. At the current moment, we only support:</li> <li> Zeek</li> <li> OSSEC</li> <li> OpenVAS</li> <li> Suricata</li> </ul>"},{"location":"quickstart/#quickstart","title":"Quickstart","text":"<p>In this section, we describe how to start receiving event logs generated by <code>Zeek</code> and shipped with <code>fluent-bit</code> with encrypted PIIs.</p>"},{"location":"quickstart/#1-generate-encryption-keys-and-configuration-file-for-fluent-bit","title":"1. Generate encryption keys and configuration file for fluent-bit","text":"<ol> <li>Create an account on securityspectrum.io</li> <li>Login and create a first organization. Mark that organization as default.</li> <li>Go to <code>Settings</code> -&gt; <code>Application Settings</code> -&gt; <code>Setup Encryption Key</code> and Click on <code>Setup encryption key</code> button to generate encryption keys.</li> <li>Verify and review selected <code>PII fields</code> with the <code>encryption mechanisms</code> by accessing <code>Privacy</code> view.</li> </ol>"},{"location":"quickstart/#2-installing-and-configuring-zeek","title":"2. Installing and configuring Zeek","text":"<ol> <li>Install Zeek</li> <li>Stop Zeek with <code>zeekctl stop</code></li> <li> <p>Go to <code>/opt/zeek/share/zeek/site/local.zeek</code> and append the following configuration at the end of the file:</p> <pre><code># @load packages\n# Output to JSON format\nload policy/tuning/json-logs.zeek\n</code></pre> </li> <li> <p>Restart Zeek:</p> <pre><code>zeekctl deploy\n</code></pre> </li> <li> <p>Verify that the logs are generated in JSON format:</p> <pre><code>tail -f /opt/zeek/logs/current/conn.log\n</code></pre> </li> </ol>"},{"location":"quickstart/#3-installing-and-configuring-fluent-bit","title":"3. Installing and configuring fluent-bit","text":"<ol> <li>Install fluent-bit with <code>encrypt</code> filter plugin available from here: &lt; link &gt;</li> <li> <p>After installation, verify that fluent-bit binary works as expected with <code>encrypt</code> plugin with the following command:</p> <p><code>fluent-bit -v ...</code></p> </li> <li> <p>Create a file <code>fluent-bit-parsers.conf</code> with the following contents:</p> <p>[PARSER]    Name        json-parser    Format      json</p> </li> <li> <p>From the view <code>Settings</code> -&gt; <code>Application settings</code> -&gt; <code>Log Shippers</code>.</p> </li> <li>If there is no fluent-bit configuration present in the view, click on <code>Add Token</code> button on top right to generate new.</li> <li>Create a new configuration file <code>fluent-bit.conf</code> with the generated fluent-bit configuration sample. You can click on the middle icon <code>Copy configuration</code> .</li> <li> <p>Click on the icon <code>Download certificates</code> and extract the three files from it. Make sure that they match the following path:</p> <pre><code>   rdkafka.ssl.ca.location          /opt/log-shippers/fluent-bit/.certs/kafka-client-cacert.crt\n   rdkafka.ssl.certificate.location /opt/log-shippers/fluent-bit/.certs/kafka-client.crt\n   rdkafka.ssl.key.location         /opt/log-shippers/fluent-bit/.certs/kafka-client.key\n</code></pre> </li> <li> <p>Make sure to update the attribute <code>Master_Enc_Key</code> value in <code>fluent-bit.conf</code> with the <code>Master Key</code> value which was generated in the 3rd step.</p> </li> <li> <p>Test fluent-bit with <code>fluent-bit -c fluent-bit.conf</code></p> </li> </ol>"}]}